names(per_data)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
union(per_data1,per_data2)
per_data <- union(per_data1,per_data2)
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
names(per_data)[1] <- c("수치")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
per_data <- union(per_data1,per_data2)
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- union(per_data1,per_data2)
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
View(per_data1)
View(per_data2)
View(per_data1)
View(per_data2)
View(per_data1)
View(per_data2)
View(per_data1)
View(per_data2)
View(per_data1)
View(per_data2)
View(per_data1)
View(per_data2)
View(per_data1)
View(per_data2)
per_data <- union(per_data1,per_data2)
View(per_data)
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"), c(per_data1, per_data2))
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
View(per_data1)
View(per_data2)
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"), (per_data1, per_data2))
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"), t(per_data1, per_data2))
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"), union(per_data1, per_data2))
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data)[1] <- c("수치")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"),
"수치"=c(per_data1[1,1:6], per_data2[1,1:6]))
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"),
"수치"=c(per_data1[1,1:6], per_data2[1,1:6]))
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 행정코드 11140550, 11560540, 11710650
region_code <- 11140550
# 종목
store_name <- "편의점"
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"),
"수치"=c(per_data1[1,1:6], per_data2[1,1:6]))
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"),
"수치"=c(per_data1[1:6,1], per_data2[1:6,1]))
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률", "개업률", "폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
View(per_data)
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "개업률", "폐업률", "평균개업률", "평균폐업률", "개업률", "폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 행정코드 11140550, 11560540, 11710650
region_code <- 11140550
# 종목
store_name <- "편의점"
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data2[1:2,1], per_data1[1:2,1],per_data2[3:4,1], per_data1[3:4,1],per_data2[5:6,1], per_data1[5:6,1]))
#num_data <- t(oriData %>% select("2018개업수", "2018폐업수", "2019개업수", "2019폐업수", "2020개업수", "2020폐업수"))
#num_data <- data.frame("년도"=c("2018", "2018", "2019", "2019", "2020", "2020"),                     "개폐업수"=c("개업수", "폐업수", "개업수", "폐업수", "개업수", "폐업수"), num_data)
#names(num_data)[3] <- c("수치")
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
library(shiny)
library(ggplot2)
library(readxl)
library("dplyr")
library("plotly")
library(tidyverse)
library(gapminder)
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 행정코드 11140550, 11560540, 11710650
region_code <- 11140550
# 종목
store_name <- "편의점"
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018", "2018", "2018", "2018", "2019", "2019", "2019", "2019", "2020", "2020", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data2[1:2,1], per_data1[1:2,1],per_data2[3:4,1], per_data1[3:4,1],per_data2[5:6,1], per_data1[5:6,1]))
#num_data <- t(oriData %>% select("2018개업수", "2018폐업수", "2019개업수", "2019폐업수", "2020개업수", "2020폐업수"))
#num_data <- data.frame("년도"=c("2018", "2018", "2019", "2019", "2020", "2020"),                     "개폐업수"=c("개업수", "폐업수", "개업수", "폐업수", "개업수", "폐업수"), num_data)
#names(num_data)[3] <- c("수치")
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균 ", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data2[1:2,1], per_data1[1:2,1],per_data2[3:4,1], per_data1[3:4,1],per_data2[5:6,1], per_data1[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균 ", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 행정코드 11140550, 11560540, 11710650
region_code <- 11140550
# 종목
store_name <- "편의점"
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
# 종목
store_name <- "편의점"
# 행정코드 11140550, 11560540, 11710650
region_code <- 11560540
# 종목
store_name <- "편의점"
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
View(oriData)
# 행정코드 11140550 명동, 11560540 여의동, 11710650 잠실본동
region_code <- 11710650
# 행정코드 11140550 명동, 11560540 여의동, 11710650 잠실본동
region_code <- 11710650
# 종목
store_name <- "편의점"
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
# 종목      편의점, 치킨집, 카페, 제과점,  분식집
store_name <- "치킨집"
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018"+"1", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
library(shiny)
library(ggplot2)
library(readxl)
library("dplyr")
library("plotly")
library(tidyverse)
library(gapminder)
# 행정코드 11140550 명동, 11560540 여의동, 11710650 잠실본동
region_code <- 11710650
# 종목      편의점, 치킨집, 카페, 제과점,  분식집
store_name <- "치킨집"
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
library(shiny)
library(ggplot2)
library(readxl)
library("dplyr")
library("plotly")
library(tidyverse)
library(gapminder)
# 행정코드 11140550 명동, 11560540 여의동, 11710650 잠실본동
region_code <- 11710650
# 종목      편의점, 치킨집, 카페, 제과점,  분식집
store_name <- "치킨집"
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
install.packages("shiny")
install.packages("ggplot2")
install.packages("readxl")
install.packages("tidyverse")
install.packages("gapminder")
library(shiny)
library(ggplot2)
library(readxl)
library("dplyr")
library("plotly")
library(tidyverse)
library(gapminder)
# 행정코드 11140550 명동, 11560540 여의동, 11710650 잠실본동
region_code <- 11710650
# 종목      편의점, 치킨집, 카페, 제과점,  분식집
store_name <- "치킨집"
# 데이터 합산
oriData <- union(data.frame("종목"="편의점",read_excel("서울시_편의점_폐업률.xlsx")), data.frame("종목"="치킨집",read_excel("서울시_치킨집_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="카페",read_excel("서울시_카페_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="제과점",read_excel("서울시_제과점_폐업률.xlsx")))
oriData <- union(oriData, data.frame("종목"="분식집",read_excel("서울시_분식집_폐업률.xlsx")))
# 이름바꾸기
names(oriData)[5] <- c("2018개업수")
names(oriData)[6] <- c("2018폐업수")
names(oriData)[7] <- c("2018개업률")
names(oriData)[8] <- c("2018폐업률")
names(oriData)[9] <- c("2019개업수")
names(oriData)[10] <- c("2019폐업수")
names(oriData)[11] <- c("2019개업률")
names(oriData)[12] <- c("2019폐업률")
names(oriData)[13] <- c("2020개업수")
names(oriData)[14] <- c("2020폐업수")
names(oriData)[15] <- c("2020개업률")
names(oriData)[16] <- c("2020폐업률")
# 그래프 변환용 데이터프레임 생성
per_data1 <- data.frame(t(oriData %>% filter(CD==11&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data1)[1] <- c("수치")
per_data2 <- data.frame(t(oriData %>% filter(CD==region_code&종목==store_name) %>% select("2018개업률", "2018폐업률", "2019개업률", "2019폐업률", "2020개업률", "2020폐업률")))
names(per_data2)[1] <- c("수치")
per_data <- data.frame("년도"=c("2018-서울평균", "2018-서울평균", "2018", "2018", "2019-서울평균", "2019-서울평균", "2019", "2019", "2020-서울평균", "2020-서울평균", "2020", "2020"),
"개폐업률"=c("평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률", "평균개업률", "평균폐업률", "지역개업률", "지역폐업률"),
"수치"=c(per_data1[1:2,1], per_data2[1:2,1],per_data1[3:4,1], per_data2[3:4,1],per_data1[5:6,1], per_data2[5:6,1]))
# 개폐업률
data_plot <- ggplot(data=per_data, aes(x=년도, y= 수치, fill = 개폐업률)) +
geom_bar(stat="identity", position=position_dodge()) + ggtitle("년도별 개업률 및 폐업률") +
theme_bw()
fig3 <- ggplotly(data_plot)
fig3
